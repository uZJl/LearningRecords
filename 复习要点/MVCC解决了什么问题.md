## 什么是MVCC

**MVCC**(Multi Version Concurrency Control的简称)，代表**多版本并发控制**。

MVCC最大的优势：**读不加锁，读写不冲突**。读写不冲突是非常重要的，极大的增加了系统的并发性能。**MVCC机制也是乐观锁的一种体现。**

InnoDB的MVCC是通过在每行记录后面保存两个隐藏的列来实现的，分别保存这条行的**创建时间**和**行的删除时间**。这里的时间并不是实际的时间值，而是**系统版本号（事务的ID）**。每开始一个新的事务系统版本号都会自动递增，事务开始时刻的系统版本号会作为事务的版本号，用来和查询到的每行记录的版本号进行比较。

 MVCC 只能在READ COMMITTED和REPEATABLE READ两个隔离级别下工作，因为READ UNCOMMITTED总是读取最新的数据行，而不是符合当前事务版本的数据行，而SERIALIZABLE则会对所有读取的行都加锁。

## MVCC解决了什么问题

多事务的并发进行一般会造成以下几个问题:

脏读: A事务读取到了B事务未提交的内容,而B事务后面进行了回滚.

不可重复读: 当设置A事务只能读取B事务已经提交的部分,会造成在A事务内的两次查询,结果竟然不一样,因为在此期间B事务进行了提交操作.

幻读: A事务读取了一个范围的内容,而同时B事务在此期间插入了一条数据.造成"幻觉".

MVCC在MySQL InnoDB中的实现主要是为了提高数据库并发性能，用更好的方式去处理读-写冲突，做到即使有读写冲突时，也能做到不加锁，非阻塞并发读

在并发读写数据库时，可以做到在读操作时不用阻塞写操作，写操作也不用阻塞读操作，提高了数据库并发读写的性能

同时还可以解决脏读，幻读，不可重复读等事务隔离问题，但不能解决更新丢失问题
